<html xmlns:v-bind="http://www.w3.org/1999/xhtml" xmlns:v-on="http://www.w3.org/1999/xhtml">
<head>
  <script src="https://unpkg.com/vue"></script>
  <link rel="stylesheet" href="styles/main.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Indie+Flower" rel="stylesheet">
  <script type="text/javascript" src="javascripts/later.min.js"></script>
  <script type="text/javascript" src="javascripts/moment.min.js"></script>
  <script type="text/javascript" src="javascripts/prettycron.js"></script>
</head>
<body>
<div id="app">
  <div>
    <input class="cron"  v-model="schedule"/>
  </div>
  <div>
    <div class="schedule">{{ schedule | schedule }}</div>
    <div class="next">next: {{ schedule | next }}</div>
  </div>
  <div>
    <i v-on:click="click" v-bind:class="{ on: isOn }" class="fa fa-globe fa-6 globe" aria-hidden="true"></i>
  </div>
</div>


</body>
<script>
  var app = new Vue({
    el: '#app',
    data: {
      isOn: false,
      schedule: '* * * * *'
    },
    methods: {
      click: function () {
        const self = this;
        const action = this.isOn ? 'off' : 'on';
        fetch('tap/' + action, {method: 'POST'}).then(function () {
          fetch('tap/').then(function (response) {
            response.json().then(function (data) {
              self.isOn = data.on;
            });
          });
        });
      }
    },
    filters: {
      schedule: function(text) {
        return prettyCron.toString(text).toLowerCase();
      },
      next: function(text) {
        return prettyCron.getNext(text).toLowerCase();
      }
    }
  });


</script>
</html>

